# SPEC 004 â€” Widgets profil rÃ©seaux sociaux
### Ã€ lire entiÃ¨rement avant de coder quoi que ce soit

---

## Contexte

Si un utilisateur renseigne des liens vers ses rÃ©seaux sociaux dans son profil,
Nexus affiche automatiquement un widget enrichi pour ce rÃ©seau.

**RÃ¨gle absolue : rien ne s'affiche si le champ est vide.**
Pas de widget vide, pas de placeholder, pas d'invitation Ã  connecter.

---

## Phase 1 â€” GitHub uniquement

GitHub est la prioritÃ© car :
- API publique et gratuite (pas de clÃ© nÃ©cessaire pour les donnÃ©es publiques)
- Parfaitement adaptÃ© Ã  la cible early adopters de Nexus
- DonnÃ©es riches et pertinentes

Les autres rÃ©seaux (YouTube, X, Instagram) sont en Phase 2.

---

## Ã‰tape 1 â€” Mise Ã  jour base de donnÃ©es

Fichier : `nexus-core/src/migrations/004_social_links.sql`

```sql
-- Remplacer le champ links (JSONB gÃ©nÃ©rique) par des champs dÃ©diÃ©s
ALTER TABLE user_profiles
ADD COLUMN github_username   VARCHAR(100),
ADD COLUMN youtube_channel   VARCHAR(200),
ADD COLUMN twitter_username  VARCHAR(100),
ADD COLUMN instagram_username VARCHAR(100),
ADD COLUMN website_url       VARCHAR(500);

-- Index pour recherche par github_username
CREATE INDEX idx_profiles_github ON user_profiles(github_username)
WHERE github_username IS NOT NULL;
```

---

## Ã‰tape 2 â€” Backend API

### Route GET /api/v1/users/:username/github
```
â†’ Accessible sans authentification
â†’ Appelle l'API GitHub publique
â†’ Met en cache dans Redis 1 heure (clÃ©: nexus:github:{github_username})
â†’ Retourne les donnÃ©es formatÃ©es pour le widget
```

Format de rÃ©ponse :
```json
{
  "login": "monusername",
  "name": "Mon Nom",
  "avatar_url": "https://avatars.githubusercontent.com/...",
  "bio": "DÃ©veloppeur passionnÃ©",
  "public_repos": 42,
  "followers": 128,
  "pinned_repos": [
    {
      "name": "mon-super-projet",
      "description": "Un projet gÃ©nial",
      "language": "TypeScript",
      "stars": 47,
      "url": "https://github.com/monusername/mon-super-projet"
    }
  ]
}
```

### Appel GitHub API (sans clÃ©)
```typescript
// Infos utilisateur
GET https://api.github.com/users/{github_username}

// Repos publics triÃ©s par stars
GET https://api.github.com/users/{github_username}/repos?sort=updated&per_page=6
```

**Note :** Sans clÃ© API, limite Ã  60 requÃªtes/heure par IP.
Le cache Redis 1 heure rÃ©sout ce problÃ¨me.

---

## Ã‰tape 3 â€” Mise Ã  jour route PATCH profil

Ajouter les nouveaux champs dans `PATCH /api/v1/users/me/profile` :
```typescript
github_username,
youtube_channel,
twitter_username,
instagram_username,
website_url
```

Validation Zod :
- `github_username` : alphanumÃ©rique + tirets, max 39 chars
- `website_url` : URL valide ou null

---

## Ã‰tape 4 â€” Composant GitHubWidget.svelte

Fichier : `nexus-frontend/src/lib/components/widgets/GitHubWidget.svelte`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ™ GitHub â€” monusername             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Avatar]  Mon Nom                   â”‚
â”‚           DÃ©veloppeur passionnÃ©     â”‚
â”‚           ğŸ“¦ 42 repos  ğŸ‘¥ 128 followers â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Repos rÃ©cents                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ mon-super-projet           â­ 47â”‚ â”‚
â”‚ â”‚ Un projet gÃ©nial  TypeScript   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ autre-projet               â­ 12â”‚ â”‚
â”‚ â”‚ Description courte  Python     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

RÃ¨gles :
- Maximum 3 repos affichÃ©s
- Lien vers le profil GitHub sur le nom d'utilisateur
- Lien vers chaque repo sur le nom du repo
- Loading skeleton pendant le fetch
- Si erreur API â†’ widget masquÃ© silencieusement (pas d'erreur visible)

---

## Ã‰tape 5 â€” IntÃ©gration dans la page profil

Fichier : `nexus-frontend/src/routes/users/[username]/+page.svelte`

Ajouter aprÃ¨s la bio :

```
[Bio]
[Tags]
[Liens]

--- Widgets rÃ©seaux sociaux ---
[GitHubWidget]     â† si github_username renseignÃ©
[YouTubeWidget]    â† Phase 2
[TwitterWidget]    â† Phase 2
```

Le widget s'affiche uniquement si `profile.github_username` est renseignÃ©.

---

## Ã‰tape 6 â€” Formulaire d'Ã©dition du profil

Fichier : `nexus-frontend/src/routes/users/me/edit/+page.svelte`

Section "RÃ©seaux sociaux" dans le formulaire :
```
GitHub          [________________]  ex: monusername
YouTube         [________________]  ex: @machaÃ®ne
Twitter / X     [________________]  ex: monpseudo
Instagram       [________________]  ex: monpseudo
Site web        [________________]  ex: https://monsite.com
```

---

## Ordre d'exÃ©cution OBLIGATOIRE

```
1. Migration SQL 004_social_links.sql
2. Appliquer la migration en base
3. Route GET /api/v1/users/:username/github
4. Mise Ã  jour PATCH /me/profile avec nouveaux champs
5. Composant GitHubWidget.svelte
6. IntÃ©gration GitHubWidget dans page profil
7. Formulaire Ã©dition profil /users/me/edit
8. Commit aprÃ¨s chaque Ã©tape
```

---

## Ce qu'on ne fait PAS dans cette spec

- OAuth "Se connecter avec GitHub" â†’ Phase 2
- Statistiques de contribution GitHub (graphe) â†’ Phase 2

---

## Roadmap des widgets rÃ©seaux sociaux

### Phase 1 â€” Maintenant
```
GitHub      âœ… API publique gratuite
```

### Phase 2 â€” Prochaine itÃ©ration
```
Twitch      â†’ API publique, parfait pour streamers
Spotify     â†’ API publique, afficher ce qu'on Ã©coute
SoundCloud  â†’ API publique, parfait pour musiciens
Steam       â†’ API publique, jeux + heures de jeu
```

### Phase 3 â€” Iterations suivantes
```
YouTube     â†’ clÃ© API Google requise
LinkedIn    â†’ API accessible, profil pro
DeviantArt  â†’ API publique, parfait pour artistes
Reddit      â†’ API publique, afficher profil
Mastodon    â†’ parfait pour l'esprit Nexus
```

### Hors scope â€” Pas d'API profil public utilisable
```
WhatsApp, WeChat, QQ, Viber     â†’ pas d'API profil
Telegram, Snapchat              â†’ pas de profil public
Tumblr, Flixster                â†’ services en dÃ©clin
G2A, EpicGames, Fab             â†’ pas d'API profil
```

### Phase suivante selon faisabilitÃ©
```
Twitter/X   â†’ API payante depuis 2023
Instagram   â†’ API trÃ¨s restrictive depuis 2019
TikTok      â†’ API trÃ¨s limitÃ©e
Pinterest   â†’ API limitÃ©e
```

---

## Note importante â€” Respect de la vie privÃ©e

L'utilisateur choisit ce qu'il expose.
Nexus n'importe JAMAIS automatiquement des donnÃ©es externes.
Chaque champ rÃ©seau social est optionnel et rempli volontairement.

---

*"Le rÃ©seau, ce sont les gens."*